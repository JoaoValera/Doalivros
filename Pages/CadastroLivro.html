<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Doar Livro - DoeLivros</title>
  <link rel="stylesheet" href="../CSS/CadastroLivros.css">
</head>
<body>

  <header class="topo">
    <div class="logo">
      <img src="./ImgLogo/ImgDoalivros2.png" alt="Logo DoaLivros">
    </div>

    <nav class="acesso">
      <a href="login1.html">Login</a> |
      <a href="Cadastro1.html">Registrar</a> |
      <a href="index.html">InÃ­cio</a>
    </nav>
  </header>

  <main class="principal">
    <h1>Doar um Livro</h1>
    <form id="formDoarLivro">
      <label for="nomeLivro">Nome do Livro:</label>
      <input type="text" id="nomeLivro" name="nomeLivro" placeholder="Digite o nome do livro" required>

      <label for="autorLivro">Autor:</label>
      <input type="text" id="autorLivro" name="autorLivro" placeholder="Digite o nome do autor" required>

      <label for="sinopseLivro">Sinopse:</label>
      <textarea id="sinopseLivro" name="sinopseLivro" rows="5" placeholder="Escreva uma breve sinopse" required></textarea>

      <button type="submit">Cadastrar Livro ðŸ“š</button>
    </form>
  </main>

  <footer class="rodape">
    <img src="./ImgLogo/ImgDoalivros2.png" alt="Logo DoaLivros">
    <p>Â© Fire Company â€“ Desenvolvido por JoÃ£o Vitor</p>
    <a href="https://www.linkedin.com/in/seu-linkedin">Meu LinkedIn</a>
  </footer>

 <script type="module">
  // O cÃ³digo aqui Ã© executado como um mÃ³dulo no contexto da pÃ¡gina.
  // ImportaÃ§Ã£o CORRIGIDA: Usa o caminho ./Js/ porque o script estÃ¡ sendo executado na Raiz.
  import { db } from './Js/Firebase.js'; 
  import { collection, addDoc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

  const form = document.getElementById('formDoarLivro');

  form.addEventListener('submit', async (e) => {
    e.preventDefault();

    const nome    = document.getElementById('nomeLivro').value;
    const autor   = document.getElementById('autorLivro').value;
    const sinopse = document.getElementById('sinopseLivro').value;

    try {
      // 1. Salva no Firestore
      await addDoc(collection(db, "livros"), {
        nome,
        autor,
        sinopse,
        criadoEm: new Date()
      });

      alert("Livro cadastrado com sucesso!");
      form.reset(); // Opcional: limpa o formulÃ¡rio

      // 2. Redireciona para a pÃ¡gina inicial (CORRIGIDO: index.html na Raiz)
      window.location.href = "index.html"; 

    } catch (err) {
      console.error("Erro ao cadastrar livro:", err);
      alert("Erro ao cadastrar livro: " + err.message);
    }
  });
</script>

</body>
</html>